<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Grafos e uma Análise Matemática do Jazz nos anos 60</title>

    <meta name="description" content="Grafos e uma Análise Matemática do Jazz nos anos 60">
    <meta name="author" content="Bernardo Fontes">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="../css/reveal.min.css">
    <link rel="stylesheet" href="../css/theme/simple.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="../lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
    	if( window.location.search.match( /print-pdf/gi ) ) {
    		var link = document.createElement( 'link' );
    		link.rel = 'stylesheet';
    		link.type = 'text/css';
    		link.href = '../css/print/pdf.css';
    		document.getElementsByTagName( 'head' )[0].appendChild( link );
    	}
    </script>
    <style type="text/css">
      .reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
        text-transform: none !important;
      }
      .reveal section img {
        border: none !important;
        box-shadow: none !important;
      }
      .reveal .progress span {
        background: #FF0000 !important;
      }

      .without_ul_style > ul {
        list-style-type: none;
      }
    </style>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-63105879-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!--[if lt IE 9]>
    <script src="../lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

      <div class="slides">
      <!-- Any section element inside of this container is displayed as a slide -->

        <section>
          <h2>PythonBrasil[13]</h2>
          <h3 style="text-decoration: line-through;">Navegando por grafos com Python</h3>
          <br>

          <h3><b>Bernardo Fontes</b></h3>
          <br>

          <h4>Belo Horizonte/BH</h4>
          <h4>08 de Outubro de 2017</h4>
        </section>

        <section>
          <h2>PythonBrasil[13]</h2>
          <h3>Grafos e uma Análise Matemática do Jazz nos anos 60</h3>
          <br>

          <h3><b>Bernardo Fontes</b></h3>
          <br>

          <h4>Belo Horizonte/BH</h4>
          <h4>08 de Outubro de 2017</h4>
        </section>

        <section>
          <h2>Só para dizer um oi!</h2>
          <h3>
            <p><a target="_blank" href="https://twitter.com/bbfontes">twitter.com/bbfontes</a></p>
            <p><a target="_blank" href="https://github.com/berinhard">github.com/berinhard</a></p>
            <p><a target="_blank" href="http://pessoas.cc/">pessoas.cc</a></p>
            <p><a target="_blank" href="mailto:bernardoxhc@gmail.com">bernardoxhc@gmail.com</a></p>
          </h3>
          <a href="http://simplefractal.com/" target="_blank">
            <img src="images/simplefractal.jpg">
          </a>
        </section>

        <section>
          <h2>
            <p>
              <a target="_blank" href="https://berinhard.github.io/talks/">berinhard.github.io/talks/</a>
            </p>
          </h2>
        </section>

        <section class="fragments" data-markdown>
          ## Gracias, [Nicolle](https://twitter.com/nicysneiros)!
          [Graph Databases: Discutindo o Relacionamento dos seus Dados com Python](https://speakerdeck.com/labcodes/graph-databases-discutindo-o-relacionamento-dos-seus-dados-com-python)
        </section>

        <section class="fragments" data-markdown>
          ## Anos 60 nos EUA
          ### O Fim da Inocência
        </section>

        <section>
          <h3>Desenvolvimento do Jazz Modal</h3>
          <p><b>Miles Davis - Kind of Blue (1959)</b></p>
          <img width="50%" src="images/kind_of_blue.jpg">
        </section>

        <section>
          <h3>Desenvolvimento do Jazz Modal</h3>
          <p><b>John Coltrane - A Love Supreme (1965)</b></p>
          <img width="50%" src="images/a_love_supreme.jpg">
        </section>

        <section>
          <h3>Estruturas Enxutas</h3>
          <p><b>Duke Ellington, Charles Mingus e Max Roach - Money Jungle (1962)</b></p>
          <img width="50%" src="images/money_jungle.jpg">
        </section>

        <section>
          <h3>Brasil, irmão</h3>
          <p><b>Stan Getz & João Gilberto - Getz/Gilberto (1964)</b></p>
          <img width="50%" src="images/getz_gilberto.jpg">
        </section>

        <section>
          <h3>Influências externas</h3>
          <p><b>Miles Davis - Miles In The Sky (1968)</b></p>
          <img width="50%" src="images/miles_in_the_skyy.jpg">
        </section>

        <section>
          <h3>Jazz Fusion</h3>
          <p><b>Herbie Hancock - Fat Albert Rotunda (1969)</b></p>
          <img width="50%" src="images/fat_albert_rotunda.jpg">
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Mas, e aí?

          - Esses são só uns nomes... E todo o **resto** da galera?
          - Quem **tocou** com mais quem?
          - **Teoria dos Grafos** é uma bom caminho para a resposta!
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Sobre Grafos

          - Estrutura composta por **nós e arestas**
          - **Nós** possuem dados
          - **Arestas** definem relações entre os nós
        </section>

        <section>
          <h3>Exemplo</h3>
          <p>Grupo de amigos</p>
          <img src="images/full_graph.jpg">
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Por que grafos?

          - Problemas em que **relação é tão importante** quanto os dados em si
          - Análise de **padrões de relação**
          - Detecção de **grandes grupos** (clusters)
          - Estudos de **centralidade**
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Nosso Grafo

          - Somente discos lançados **nos EUA nos anos 60**
          - **Músicos** e **Álbuns** como nós
          - Relação entre **músicos que tocaram juntos**
          - Relação entre **músicos e álbuns que participaram**
        </section>

        <section>
          <h3>Busca no Discogs</h3>
          <img width="90%" src="images/base_filter.png">
        </section>

        <section>
          <a href="https://github.com/berinhard/jazz-graph" target="_blank">
            <img src="images/jazz-graph.png">
          </a>
        </section>

        <section>
          <h3>Resultado (RECORDED)</h3>
          <img width="70%" src="images/RECORDED.png">
        </section>

        <section>
          <h3>Resultado (PLAYED_WITH)</h3>
          <img src="images/PLAYED_WITH.png">
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Três perguntas

          - Quem **participou de mais discos**?
          - Quem são os **músicos mais influentes** na rede?
          - Quais são os **discos mais influentes** na rede?
        </section>

        <section class="fragments" data-markdown>
          ## jazz_musicians_graph.json

          ```python
          {
            'nodes': {
              "2808823": {
                "name": "Johnny Allen", "roles": ["Bass"], "type": "MUSICIAN"
              },
              "325859": {
                "name": "Danny Barcelona", "roles": ["Drums"], "type": "MUSICIAN"
              },
              "3942191-Cugat's Golden Goodies": {
                "year": 1963, "type": "RELEASE", "title": "Cugat's Golden Goodies"
              },
              "5004667-The Shearing Touch": {
                "year": 1960, "type": "RELEASE", "title": "The Shearing Touch"
              },
              ...
            },
            'links': [
              ["2808823", "325859", {'type': 'PLAYED_WITH', 'release_id': "5004667-The Shearing Touch", 'roles': ['Bass']},
              ["2808823", "5004667-The Shearing Touch", {'type': 'RECORDED', 'roles': ['Bass']},
            ...
            ]
          }
          ```
        </section>

        <section>
          <a href="https://networkx.github.io/" target="_blank">
            <img src="images/networkx.png">
          </a>
        </section>

        <section class="fragments" data-markdown>
          ### Montando o grafo completo

          ```
          import networkx as nx

          master_graph = nx.MultiDiGraph()
          with open(GRAPH_JSON_FILE) as fd:
              graph_data = json.load(fd)
              master_graph.add_nodes_from(graph_data['nodes'].items())
              master_graph.add_edges_from(graph_data['edges'])

          print(master_graph.number_of_node())
          print(master_graph.number_of_edges())
          ```
        </section>

        <section class="fragments" data-markdown>
          ### Grafo `RECORDED`

          ```
          def extract_recorded_graph(master_graph):
              graph = nx.Graph()
              graph.add_nodes_from(master_graph.nodes())

              flatten = flatten_edges(master_graph)
              for source, target, rel_data in flatten:
                if rel_data['type'] != 'RECORDED':
                  continue
                graph.add_edge(source, target, **rel_data)

              return graph


          recorded_graph = extract_recorded_graph(master_graph):)
          ```
        </section>

        <section class="fragments" data-markdown>
          ### Grafo `PLAYED_WITH`

          ```
          def extract_played_with_graph(master_graph):
              graph = nx.Graph()
              for n, data in master_graph.nodes(data=True):
                if data['type'] == 'MUSICIAN':
                  graph.add_node(n, **data)

              flatten = flatten_edges(master_graph)
              for source, target, data in flatten:
                if not data['type'] == 'PLAYED_WITH':
                  continue
                if not graph.has_edge(source, target):
                  graph.add_edge(source, target, weight=0, **data)
                graph.edges[(source, target)]['weight'] += 1

              return graph

          played_with_graph = extract_played_with_graph(graph)
          ```
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Centralidade

          - Medida de **importância** de um nó em um grafo
          - **de Grau**: baseada no número de ligações de um nó
          - **de Contribuição**: baseada na contribuição topológica de um nó em um grafo
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## Três Respostas

          - Quem participou de mais discos?
          - **Centralidade de grau no grafo RECORDED**
          - Quem são os músicos mais influentes na rede?
          - **Centralidade de contribuição no grafo PLAYED_WITH**
          - Quais são os discos mais influentes na rede?
          - **Centralidade de contribuição no grafo RECORDED**
        </section>

        <section class="fragments" data-markdown>
          ### Métricas

          ```
          def top_10_recorders(recorded_graph, master_graph):
              centralities = nx.degree_centrality(recorded_graph)
              is_musician = lambda n: master_graph.node[n]['type'] == 'MUSICIAN'
              sorted_centralities = sorted(
                centralities, key=centralities.get, reverse=True
              )
              sorted_nodes = [n for n in sorted_centralities if is_musician(n)]
              return sorted_nodes[:10], centralities

          def top_10_musicians_influence(played_with_graph, master_graph):
              centralities = nx.eigenvector_centrality(played_with_graph, weight='weight')
              sorted_centralities = sorted(
                centralities, key=centralities.get, reverse=True
              )
              return sorted_centralities[:10], centralities

          def top_10_albuns(recorded_graph, master_graph):
              centralities = nx.eigenvector_centrality(recorded_graph)
              is_album = lambda n: master_graph.node[n]['type'] == 'RELEASE'
              sorted_centralities = sorted(
                centralities, key=centralities.get, reverse=True
              )
              sorted_nodes = [n for n in sorted_centralities if is_album(n)]
              return sorted_nodes[:10], centralities
          ```
        </section>

        <section data-markdown>
            ## Talk is cheap...
        </section>

        <section data-markdown>
          ### Top 10 Recorders
          ```
          1) Ron Carter - Baixo
          2) George Duvivier - Baixo
          3) Richard Davis (2) - Baixo
          4) Clark Terry - Trompete
          5) Grady Tate - Percurssão
          6) Kenny Burrell - Guitarra
          7) Bob Cranshaw - Baixop
          8) Jerome Richardson - Sax
          9) Paul Chambers (3) - Baixo
          10) Herbie Hancock - Piano
          ```
        </section>

        <section data-markdown>
          ### Top 10 Prolific Musicians
          ```
          1) Ernie Royal - Trompete
          2) Jerome Richardson - Sax
          3) Grady Tate - Percursão
          4) Jimmy Cleveland - Trombone
          5) George Duvivier - Baixo
          6) Clark Terry - Trompete
          7) Urbie Green - Trombone
          8) Joe Newman - Tropmete
          9) Richard Davis (2) - Baixo
          10) Jim Buffington - Trompete
          ```
        </section>

        <section>
          <p>5 álbuns mais influentes na rede</p>
          <p>
            <a href="https://www.discogs.com/Quincy-Jones-Plays-Hip-Hits/release/757588" target="_blank"><img width="32%" src="images/01_album.jpg"></a>
            <a href="https://www.discogs.com/Oliver-Nelson-Full-Nelson/master/224661" target="_blank"><img width="32%" src="images/02_album.jpg"></a>
            <a href="https://www.discogs.com/Bobby-Hutcherson-Happenings/release/1391571" target="_blank"><img width="32%" src="images/03_album.jpg"></a>
          </p>
          <p>
            <a href="https://www.discogs.com/The-Incredible-Jimmy-Smith-Peter-The-Wolf/master/33159" target="_blank"><img width="32%" src="images/04_album.jpg"></a>
            <a href="https://www.discogs.com/Astrud-Gilberto-Beach-Samba/master/111015" target="_blank"><img width="32%" src="images/05_album.jpg"></a>
          </p>
        </section>

        <section class="fragments without_ul_style" data-markdown>
          ## O que dá mais pra fazer?

          - Base de dados mais completa: allmusic.com
          - Como chegar de um músico a outro?
          - Quais são os núcleos?
          - Estudar outros estilos
        </section>

        <section>
          <h3>Um indicação</h3>
          <p><b>9) Gil Evans - The Individualism of Gil Evans (1964)</b></p>
          <img width="50%" src="images/gil_evans.jpg">
        </section>

        <section>
          <h2>Obrigado!</h2>
          <h3>
            <br/>
            <p>Bernardo Fontes</p>
            <br/>
            <p><a target="_blank" href="https://twitter.com/bbfontes">twitter.com/bbfontes</a></p>
            <p><a target="_blank" href="https://github.com/berinhard">github.com/berinhard</a></p>
            <p><a target="_blank" href="http://pessoas.cc/">pessoas.cc</a></p>
            <p><a target="_blank" href="mailto:bernardoxhc@gmail.com">bernardoxhc@gmail.com</a></p>
          </h3>
          <a href="http://simplefractal.com/" target="_blank">
            <img src="images/simplefractal.jpg">
          </a>
        </section>

      </div>

    </div>

    <script src="../lib/js/head.min.js"></script>
    <script src="../js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: false,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        // transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
        transition: 'zoom',

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
        { src: 'lib/js/classList.js',
          condition: function() { return !document.body.classList; } },
        { src: '../plugin/markdown/marked.js',
          condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: '../plugin/markdown/markdown.js',
          condition: function() { return !!document.querySelector( '[data-markdown]' ); },
          callback: function() {
            Array.prototype.forEach.call(
            document.querySelectorAll('section.fragments > ul > li'),
              function(ele){ ele.className = 'fragment roll-in'; });
            } },
        { src: '../plugin/highlight/highlight.js', async: true,
          callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: '../plugin/zoom-js/zoom.js', async: true,
          condition: function() { return !!document.body.classList; } },
        { src: '../plugin/notes/notes.js', async: true,
          condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>
  </body>
</html>
